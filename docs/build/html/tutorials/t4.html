<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Tutorial 5 - Gaussian measures" href="t5.html" /><link rel="prev" title="Tutorial 3 - Dual spaces" href="t3.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.07.19 -->
        <title>Tutorial 4 - Linear operators - pygeoinf documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pygeoinf  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">pygeoinf  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="t1.html">Tutorial 1 - A first example</a></li>
<li class="toctree-l1"><a class="reference internal" href="t2.html">Tutorial 2 - Hilbert spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="t3.html">Tutorial 3 - Dual spaces</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorial 4 - Linear operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="t5.html">Tutorial 5 - Gaussian measures</a></li>
<li class="toctree-l1"><a class="reference internal" href="t6.html">Tutorial 6 - Minumum norm inversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="t7.html">Tutorial 7 - Bayesian inversions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/hilbert_space.html">pygeoinf.hilbert_space</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/operators.html">pygeoinf.operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/forms.html">pygeoinf.forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/gaussian_measure.html">pygeoinf.gaussian_measure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/direct_sum.html">pygeoinf.direct_sum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/linear_solvers.html">pygeoinf.linear_solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/forward_problem.html">pygeoinf.forward_problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/inversion.html">pygeoinf.inversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/linear_optimisation.html">pygeoinf.linear_optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/linear_bayesian.html">pygeoinf.linear_bayesian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/random_matrix.html">pygeoinf.random_matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/symmetric_spaces.html">Symmetric Spaces</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/t4.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment and run this when using colab.</span>
<span class="c1">#%pip install pygeoinf</span>
</pre></div>
</div>
</div>
<section id="Tutorial-4---Linear-operators">
<h1>Tutorial 4 - Linear operators<a class="headerlink" href="#Tutorial-4---Linear-operators" title="Link to this heading">¶</a></h1>
<p>In this tutorial, we consider the implementation of linear operators within the <code class="docutils literal notranslate"><span class="pre">pygeoinf</span></code> library through the <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> class.</p>
<section id="Defining-a-linear-operator">
<h2>Defining a linear operator<a class="headerlink" href="#Defining-a-linear-operator" title="Link to this heading">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> be two Hilbert spaces represented by <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code> objects. A linear operator between them is specified through its mapping. This is shown in the following example using instances of <code class="docutils literal notranslate"><span class="pre">EuclideanSpace</span></code> as the domain and codomain of the mapping.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoinf</span><span class="w"> </span><span class="kn">import</span> <span class="n">EuclideanSpace</span><span class="p">,</span> <span class="n">LinearOperator</span>

<span class="c1"># Set the domain of the operator.</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Set the codomain of the operator.</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Define the linear operator as a projection from X to Y.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="n">Y</span><span class="o">.</span><span class="n">dim</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Having defined the operator, we can compute its action on vectors as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x =  </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ax = </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
x =  [-0.11415349  1.38619828 -1.04610582  1.54245682 -0.74082673]
Ax = [-0.11415349  1.38619828 -1.04610582]
</pre></div></div>
</div>
<p>Linear operators can be combined in the usual manners so long as their domains and codomains are compatible. For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Project the final elements onto Y.</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="n">Y</span><span class="o">.</span><span class="n">dim</span><span class="p">:])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x          = </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ax         = </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Bx         = </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">B</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(A + 2 B)x = </span><span class="si">{</span><span class="n">z</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Ax + 2 Bx  = </span><span class="si">{</span><span class="n">y</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Inclusion of Y into X.</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">dim</span><span class="o">-</span><span class="n">Y</span><span class="o">.</span><span class="n">dim</span><span class="p">)]))</span>

<span class="n">E</span> <span class="o">=</span> <span class="n">D</span> <span class="o">@</span> <span class="n">A</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;D(Ax)      = </span><span class="si">{</span><span class="n">D</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(DA)x      = </span><span class="si">{</span><span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
x          = [-0.41847086 -0.61023093  2.11319    -0.33582984 -0.54078921]
Ax         = [-0.41847086 -0.61023093  2.11319   ]
Bx         = [ 2.11319    -0.33582984 -0.54078921]
(A + 2 B)x = [ 3.80790915 -1.28189062  1.03161159]
Ax + 2 Bx  = [ 3.80790915 -1.28189062  1.03161159]
D(Ax)      = [-0.41847086 -0.61023093  2.11319     0.          0.        ]
(DA)x      = [-0.41847086 -0.61023093  2.11319     0.          0.        ]
</pre></div></div>
</div>
<p>Algebraic combinations of such operators are always detemrined lazily, and hence there is essentially no cost in forming the combinations until their action on a vector is computed.</p>
</section>
<section id="Dual-operators">
<h2>Dual operators<a class="headerlink" href="#Dual-operators" title="Link to this heading">¶</a></h2>
<p>For a linear operator, <span class="math notranslate nohighlight">\(A \in \mathrm{Hom}(X,Y)\)</span>, the corresponding <strong>dual operator</strong>, <span class="math notranslate nohighlight">\(A' \in \mathrm{Hom}(Y',X')\)</span> is defined through</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\langle y', Ax \rangle = \langle A'y', x \rangle,\]</div>
</div>
<p>for all <span class="math notranslate nohighlight">\(x \in X\)</span> and <span class="math notranslate nohighlight">\(y' \in Y'\)</span>. Such an operator can be accessed from a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> using its <code class="docutils literal notranslate"><span class="pre">dual</span></code> property. This is shown in the code below where we verify that the defining identity holds.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">dual</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;yp, Ax&gt;    = </span><span class="si">{</span><span class="n">yp</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;Ap(yp), x&gt; = </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">dual</span><span class="p">(</span><span class="n">yp</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;yp, Ax&gt;    = -0.08402357088716553
&lt;Ap(yp), x&gt; = -0.08402357088716553
</pre></div></div>
</div>
<p>Here we see that once a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> has been defined its dual is automatically available. This is done internally using the defining relation for the dual operator. However, this implementation is inefficient and should be used rarely. Indeed, the action of of this dual operator on a vector of dimension <span class="math notranslate nohighlight">\(n\)</span> requires <span class="math notranslate nohighlight">\(n\)</span> actions of the original operator to be computed. Rather, when constructing a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> the dual mapping can be provided directly as a key-word
argument.</p>
<p>Consider the projection operator, <span class="math notranslate nohighlight">\(A\)</span>, defined above. In this case we see that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\langle y', Ax \rangle = \sum_{i=1}^{m} y'_{i} x_{i},\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(m = \dim Y\)</span>. It follows that <span class="math notranslate nohighlight">\(A'y'\)</span> is the element of <span class="math notranslate nohighlight">\(X'\)</span> whose first <span class="math notranslate nohighlight">\(m\)</span> components equal those of <span class="math notranslate nohighlight">\(y'\)</span> while all others are zero. Using this result, we can re-implement the projection operator as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the mapping and the dual mapping</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mapping</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[:</span><span class="n">Y</span><span class="o">.</span><span class="n">dim</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dual_mapping</span><span class="p">(</span><span class="n">yp</span><span class="p">):</span>
    <span class="n">cyp</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">dual</span><span class="o">.</span><span class="n">to_components</span><span class="p">(</span><span class="n">yp</span><span class="p">)</span>
    <span class="n">cxp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">cyp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">dim</span><span class="o">-</span><span class="n">Y</span><span class="o">.</span><span class="n">dim</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">dual</span><span class="o">.</span><span class="n">from_components</span><span class="p">(</span><span class="n">cxp</span><span class="p">)</span>

<span class="c1"># Construct the operator.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">dual_mapping</span><span class="o">=</span><span class="n">dual_mapping</span><span class="p">)</span>

<span class="c1"># Check that it performs as required.</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">dual</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;yp, Ax&gt;    = </span><span class="si">{</span><span class="n">yp</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;Ap(yp), x&gt; = </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">dual</span><span class="p">(</span><span class="n">yp</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;yp, Ax&gt;    = 0.6977529510738387
&lt;Ap(yp), x&gt; = 0.6977529510738387
</pre></div></div>
</div>
</section>
<section id="Adjoint-operators">
<h2>Adjoint operators<a class="headerlink" href="#Adjoint-operators" title="Link to this heading">¶</a></h2>
<p>For <span class="math notranslate nohighlight">\(A \in \mathrm{Hom}(X,Y)\)</span> we can also define its <strong>adjoint operator</strong>, <span class="math notranslate nohighlight">\(A^{*} \in \mathrm{Hom}(Y, X)\)</span>, through</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(y, Ax)_{Y} = (A^{*}y, x)_{X},\]</div>
</div>
<p>for all <span class="math notranslate nohighlight">\(x \in X\)</span> and <span class="math notranslate nohighlight">\(y \in Y\)</span>. For a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> the adjoint can be accessed through its <code class="docutils literal notranslate"><span class="pre">adjoint</span></code> property:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the projection again just in terms of its mapping.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(y,Ax)  = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(A*y,x) = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(y,Ax)  = -0.881393659461033
(A*y,x) = -0.881393659461033
</pre></div></div>
</div>
<p>The dual and adjoint operators are related, and in the above case this relation is used to determine the adjoint from the automatically generated dual. Recalling the Riesz representation theorem in terms of an isometric isomorphisms <span class="math notranslate nohighlight">\(J_{X} = \mathrm{Hom}(X',X)\)</span> and <span class="math notranslate nohighlight">\(J_{Y} = \mathrm{Hom}(Y',Y)\)</span>, it is readily seen that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A^{*} = J_{X} A' J_{Y}^{-1}.\]</div>
</div>
<p>If a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> is constructed given an explicit dual mapping, then the above relation is used to efficiently implement its adjoint. Equally, an <code class="docutils literal notranslate"><span class="pre">adjoint_mapping</span></code> can be provided as a key-word argument, and then the above relation generates the dual mapping.</p>
<p>In the case of the projection, <span class="math notranslate nohighlight">\(A\)</span>, from <span class="math notranslate nohighlight">\(X\)</span> to <span class="math notranslate nohighlight">\(Y\)</span>, a simple calculation shows that <span class="math notranslate nohighlight">\(A^{*}\)</span> is just the inclusion from <span class="math notranslate nohighlight">\(Y\)</span> into <span class="math notranslate nohighlight">\(X\)</span>. We can, therefore, implement this operator as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">adjoint_mapping</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">dim</span><span class="o">-</span><span class="n">Y</span><span class="o">.</span><span class="n">dim</span><span class="p">)])</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">adjoint_mapping</span><span class="o">=</span><span class="n">adjoint_mapping</span><span class="p">)</span>

<span class="c1"># Test the adjoint</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(y,Ax)     = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(A*y,x)    = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Test the dual</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">dual</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;yp,Ax&gt;    = </span><span class="si">{</span><span class="n">yp</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;Ap(yp),x&gt; = </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">dual</span><span class="p">(</span><span class="n">yp</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(y,Ax)     = -0.24017696243918896
(A*y,x)    = -0.24017696243918896
&lt;yp,Ax&gt;    = 0.13365937051420906
&lt;Ap(yp),x&gt; = 0.13365937051420906
</pre></div></div>
</div>
</section>
<section id="Matrix-representations">
<h2>Matrix representations<a class="headerlink" href="#Matrix-representations" title="Link to this heading">¶</a></h2>
<p>If <span class="math notranslate nohighlight">\(X\)</span> is modeled by a <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code>, recall that we have mappings <span class="math notranslate nohighlight">\(P_{X} \in \mathrm{Hom}(X, \mathbb{R}^{n})\)</span> and <span class="math notranslate nohighlight">\(I_{X} \in \mathrm{Hom}(\mathbb{R}^{n},X)\)</span> that, respectively, map vectors to and from their components. Given a linear operator, <span class="math notranslate nohighlight">\(A \in \mathrm{Hom}(X,Y)\)</span> we can then define its <strong>matrix representation</strong> by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\hat{A} = P_{Y} A I_{X} \in \mathrm{Hom(\mathbb{R}^{n}, \mathbb{R}^{m})}.\]</div>
</div>
<p>This operator can be viewed as an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix, and from a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> it can be accessed as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ah</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">dense</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ah</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
</pre></div></div>
</div>
<p>Note the inclusion of the key-word argument <code class="docutils literal notranslate"><span class="pre">dense</span></code> when using the <code class="docutils literal notranslate"><span class="pre">matrix</span></code> method. Without this, the default is to return the matrix representation as a <code class="docutils literal notranslate"><span class="pre">scipy</span></code> <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> instance. This latter option is useful when interfacing between <code class="docutils literal notranslate"><span class="pre">pygeoinf</span></code> operators and numerical algorithms within the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> package.</p>
<p>The dense matrix representation is generated by successively acting the operator on basis vectors for the space. A <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> can also be printed, the result just being its dense matrix representation:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
</pre></div></div>
</div>
<p>If the matrix representation of an linear operator is available, this can be used to generate the correspondind <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> using the static method <code class="docutils literal notranslate"><span class="pre">from_matrix</span></code>. The matrix used can either be a dense <code class="docutils literal notranslate"><span class="pre">numpy</span></code> matrix or a <code class="docutils literal notranslate"><span class="pre">scipy</span></code> <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code>. As an example, we can reconstruct our projection operator using its dense matrix representation:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Form the operator from a matrix.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ah</span><span class="p">)</span>

<span class="c1"># Test the adjoint</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(y,Ax)     = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(A*y,x)    = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Test the dual</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">dual</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;yp,Ax&gt;    = </span><span class="si">{</span><span class="n">yp</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;Ap(yp),x&gt; = </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">dual</span><span class="p">(</span><span class="n">yp</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(y,Ax)     = -0.17039623488783748
(A*y,x)    = -0.17039623488783748
&lt;yp,Ax&gt;    = 0.07440943617372242
&lt;Ap(yp),x&gt; = 0.07440943617372242
</pre></div></div>
</div>
</section>
<section id="Galerkin-matrix-representation">
<h2>Galerkin matrix representation<a class="headerlink" href="#Galerkin-matrix-representation" title="Link to this heading">¶</a></h2>
<p>On a Hilbert space, a second useful matrix representation of a linear operator is available. Let <span class="math notranslate nohighlight">\(A\in \mathrm{Hom}(X,Y)\)</span> and <span class="math notranslate nohighlight">\(\{e_{j}\}\)</span> and <span class="math notranslate nohighlight">\(\{f_{i}\}\)</span> be bases for <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>, respectively. The <strong>Galerkin matrix representation</strong> is the linear operator, <span class="math notranslate nohighlight">\(\tilde{A} \in \mathrm{Hom}(\mathbb{R}^{n}, \mathbb{R}^{m})\)</span>, with components</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{A}_{ij} = (f_{i}, A e_{j})_{Y}.\]</div>
</div>
<p>Equivalently, we can express this matrix as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\tilde{A} = P_{Y'}J_{Y}^{-1}A I_{X}.\]</div>
</div>
<p>From a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code>, its Galerkin matrix representation can be accessed from the <code class="docutils literal notranslate"><span class="pre">matrix</span></code> method by setting the keyword argument <code class="docutils literal notranslate"><span class="pre">galerkin=True</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ag</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">dense</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">galerkin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Ag</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0.]
 [0. 0. 1. 0. 0.]]
</pre></div></div>
</div>
<p>In this example, the two matrix representations coincide because the mapping from Euclidean space to its dual is trivial. This is not the case in more general Hilbert spaces, however. The <code class="docutils literal notranslate"><span class="pre">from_matrix</span></code> method can also use Galerking representations to construct a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct a operator from its Galerkin matrix.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Ag</span><span class="p">,</span> <span class="n">galerkin</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Test the adjoint</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(y,Ax)     = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(A*y,x)    = </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Test the dual</span>
<span class="n">yp</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">dual</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;yp,Ax&gt;    = </span><span class="si">{</span><span class="n">yp</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;Ap(yp),x&gt; = </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">dual</span><span class="p">(</span><span class="n">yp</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(y,Ax)     = -0.20919992686705868
(A*y,x)    = -0.20919992686705868
&lt;yp,Ax&gt;    = 0.66853019671021
&lt;Ap(yp),x&gt; = 0.66853019671021
</pre></div></div>
</div>
</section>
<section id="Self-dual-and-self-adjoint-operators">
<h2>Self-dual and self-adjoint operators<a class="headerlink" href="#Self-dual-and-self-adjoint-operators" title="Link to this heading">¶</a></h2>
<p>A linear operator <span class="math notranslate nohighlight">\(A \in \mathrm{Hom}(X, X')\)</span> is said to be <strong>self-dual</strong> if <span class="math notranslate nohighlight">\(A' = A\)</span>. Similarly, an operator <span class="math notranslate nohighlight">\(A \in \mathrm{Hom}(X) = \mathrm{Hom}(X,X)\)</span> is self-adjoint if <span class="math notranslate nohighlight">\(A^{*} = A\)</span>. The following results hold:</p>
<ul class="simple">
<li><p>The matrix representation of a self-dual operator is always symmetric.</p></li>
<li><p>The Galerkin matrix representation of a self-adjoint operator is always symmetric.</p></li>
</ul>
<p>These results follow readily from the definitions above along with the identities:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[I_{X}' = J_{\mathbb{R}^{n}}^{-1}P_{X'}, \quad P_{X}' = I_{X'}J_{\mathbb{R}^{n}}.\]</div>
</div>
<p>If an operator is known to be self-dual or self-adjoint, then its construction can be simplified using the static methods <code class="docutils literal notranslate"><span class="pre">self_dual</span></code> and <code class="docutils literal notranslate"><span class="pre">self_adjoint</span></code>, respectively, which only require the operators domain and mapping to be provided.</p>
</section>
<section id="Formal-adjoints">
<h2>Formal adjoints<a class="headerlink" href="#Formal-adjoints" title="Link to this heading">¶</a></h2>
<p>In addition to duals and adjoint, the further concept of a formal adjoint is useful when considering function spaces. Consider, for example, the Sobolev space <span class="math notranslate nohighlight">\(H^{s}(\mathbb{S}^{1})\)</span> discussed in earlier tutorials. The derivative mapping:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A u = \frac{\mathrm{d}u}{\mathrm{d}\theta},\]</div>
</div>
<p>is continuous from <span class="math notranslate nohighlight">\(H^{s}(\mathbb{S}^{1})\)</span> to <span class="math notranslate nohighlight">\(H^{s-1}(\mathbb{S}^{1})\)</span>. Determining the adjoint of this operator is possible, but it is complicated by the need to consider the inner products on the two spaces. The dual mapping can be readily determined using the theory of distributions, but implementing this requires explicit consideration of the <code class="docutils literal notranslate"><span class="pre">LinearForms</span></code> class. Instead, it is easier to first compute the operators <strong>formal adjoint</strong>, <span class="math notranslate nohighlight">\(A^{\dagger}\)</span>, this being the
adjoint defined relative to the <span class="math notranslate nohighlight">\(L^{2}(\mathbb{S}^{1})\)</span> inner product for smooth functions.</p>
<p>In this particular case, we see that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\int_{0}^{2\pi} (A^{\dagger}v) u \,\mathrm{d} \theta = \int_{0}^{2\pi} v \frac{\mathrm{d}u}{\mathrm{d}\theta} \,\mathrm{d} \theta
= -\int_{0}^{2\pi}  \frac{\mathrm{d}v}{\mathrm{d}\theta} u \,\mathrm{d} \theta,\]</div>
</div>
<p>and hence the formal adjoint is <span class="math notranslate nohighlight">\(A^{\dagger} = -A\)</span>. The relation of the formal adjoint and dual operator is as follows:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[A' = I_{X'}P_{X}A^{\dagger}I_{Y}P_{Y'}.\]</div>
</div>
<p>In such cases, we can provide <code class="docutils literal notranslate"><span class="pre">formal_adjoint_mapping</span></code> as an optional argument to the constructor. There is also a static method <code class="docutils literal notranslate"><span class="pre">formally_self_adjoint</span></code> in cases where the operator is formally self-adjoint.</p>
<p>To implement these ideas in practice, we can use the Fourier expansions that underlie our implementation of <span class="math notranslate nohighlight">\(H^{s}(\mathbf{S}^{1})\)</span>. Recall that each element of this space takes the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[u = \sum_{k=\infty}^{\infty} u_{k} \phi_{k},\]</div>
</div>
<p>with basis functions defined by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\phi_{k}(\theta) = \frac{1}{\sqrt{2\pi}} \mathrm{e}^{\mathrm{i} k \theta}\]</div>
</div>
<p>It follows that</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\frac{\mathrm{d}u}{\mathrm{d}\theta} = \sum_{k=\infty}^{\infty} \mathrm{i} k u_{k} \phi_{k},\]</div>
</div>
<p>and hence in terms of Fourier coefficients differentiation us just a wavenumber-dependent scaling.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pygeoinf.symmetric_space.circle</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sobolev</span>


<span class="c1"># Set up the spaces. Note the length scales can vary between the two.</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">length_scale_1</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">length_scale_2</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">Sobolev</span><span class="o">.</span><span class="n">from_sobolev_parameters</span><span class="p">(</span><span class="n">order</span><span class="p">,</span><span class="n">length_scale_1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">Sobolev</span><span class="o">.</span><span class="n">from_sobolev_parameters</span><span class="p">(</span><span class="n">order</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">length_scale_2</span><span class="p">)</span>

<span class="c1"># Define the derivative mapping</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mapping</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="n">coeff</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">to_coefficient</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coeff</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">coeff</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k</span>
    <span class="k">return</span> <span class="n">Y</span><span class="o">.</span><span class="n">from_coefficient</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>

<span class="c1"># Define the formal adjoint. Note that this</span>
<span class="c1"># needs a separate definition because the two</span>
<span class="c1"># spaces have different spatial discretisations.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">formal_adjoint_mapping</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">coeff</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">to_coefficient</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coeff</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
        <span class="n">coeff</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k</span>
    <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">from_coefficient</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>


<span class="c1"># Set up the operator.</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">LinearOperator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">formal_adjoint_mapping</span><span class="o">=</span><span class="n">formal_adjoint_mapping</span><span class="p">)</span>

<span class="c1"># Define a function on the domain</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">project_function</span><span class="p">(</span><span class="k">lambda</span> <span class="n">th</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">Y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Check the adjoint identity using random functions.</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">heat_gaussian_measure</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">nu</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">heat_gaussian_measure</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">mu</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">nu</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">Y</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(v,Au) =  </span><span class="si">{</span><span class="n">Y</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(A*v,u) = </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">inner_product</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">v</span><span class="p">),</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_t4_30_0.png" src="../_images/tutorials_t4_30_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_t4_30_1.png" src="../_images/tutorials_t4_30_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(v,Au) =  -10.236171815918802
(A*v,u) = -10.236171815918805
</pre></div></div>
</div>
</section>
<section id="LinearOperators-linked-to-a-HilbertSpace">
<h2><code class="docutils literal notranslate"><span class="pre">LinearOperators</span></code> linked to a <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code><a class="headerlink" href="#LinearOperators-linked-to-a-HilbertSpace" title="Link to this heading">¶</a></h2>
<p>Each <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code> has methods that return a set of standard linear operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coordinate_inclusion</span></code>: A property that returns <span class="math notranslate nohighlight">\(I_{X}\)</span> as a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> from the appropriate <code class="docutils literal notranslate"><span class="pre">EuclideanSpace</span></code> into the space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coordinate_projection</span></code>: A property that returns <span class="math notranslate nohighlight">\(P_{X}\)</span> as a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> from the space into the appropriate <code class="docutils literal notranslate"><span class="pre">EuclideanSpace</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">riesz</span></code>: A property that returns <span class="math notranslate nohighlight">\(J_{X}\)</span> as a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> from the dual onto the space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_riesz</span></code>: A property that returns <span class="math notranslate nohighlight">\(J_{X}^{-1}\)</span> as a <code class="docutils literal notranslate"><span class="pre">LinearOperator</span></code> from the space to its dual.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">identity_operator</span></code>: A method that returns the identity operator on the space.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zero_operator</span></code>: A method that returns the zero operator on the space. Optinally, the codomain can be provided through the keyword argument, `<code class="docutils literal notranslate"><span class="pre">codomain</span></code>.</p></li>
</ul>
<p>The various <code class="docutils literal notranslate"><span class="pre">HilbertSpaces</span></code> that have been implemented within <code class="docutils literal notranslate"><span class="pre">pygeoinf</span></code> often have more specific linear operators pre-defined. For example, <span class="math notranslate nohighlight">\(H^{s}(\mathbb{S}^{1})\)</span> has <code class="docutils literal notranslate"><span class="pre">point_evaluation_operator</span></code> that maps an element to its values at a set of points. This method was used within Tutorial 1 to define the forward operator within the inverse problem considered.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="t5.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tutorial 5 - Gaussian measures</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="t3.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tutorial 3 - Dual spaces</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, David Al-Attar, Dan Heathcote, Adrian Mag
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorial 4 - Linear operators</a><ul>
<li><a class="reference internal" href="#Defining-a-linear-operator">Defining a linear operator</a></li>
<li><a class="reference internal" href="#Dual-operators">Dual operators</a></li>
<li><a class="reference internal" href="#Adjoint-operators">Adjoint operators</a></li>
<li><a class="reference internal" href="#Matrix-representations">Matrix representations</a></li>
<li><a class="reference internal" href="#Galerkin-matrix-representation">Galerkin matrix representation</a></li>
<li><a class="reference internal" href="#Self-dual-and-self-adjoint-operators">Self-dual and self-adjoint operators</a></li>
<li><a class="reference internal" href="#Formal-adjoints">Formal adjoints</a></li>
<li><a class="reference internal" href="#LinearOperators-linked-to-a-HilbertSpace"><code class="docutils literal notranslate"><span class="pre">LinearOperators</span></code> linked to a <code class="docutils literal notranslate"><span class="pre">HilbertSpace</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>